
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>Monitoring Hadoop Benchmarks TeraGen/TeraSort with Ganglia - Software, Physics, Data, Mountains</title>
  <meta name="author" content="Mark M Mims, Ph.D.">

  
  <meta name="description" content="Here I’m using new features of
Ubuntu Server (namely juju)
to easily deploy
Ganglia
alongside
a small Hadoop cluster
to play around with monitoring &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://markmims.com/cloud/2011/09/03/terasort-ganglia.html">
  <link href="/favicon.ico" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <link href="/atom.xml" rel="alternate" title="Software, Physics, Data, Mountains" type="application/atom+xml">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
  <script>!window.jQuery && document.write(unescape('%3Cscript src="./javascripts/lib/jquery.min.js"%3E%3C/script%3E'))</script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="http://fonts.googleapis.com/css?family=Ubuntu:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="http://fonts.googleapis.com/css?family=Ubuntu:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">

<!-- mathjax config similar to math.stackexchange -->

<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    tex2jax: {
      inlineMath: [ ['$','$'], ["\\(","\\)"] ],
      processEscapes: true
    }
  });
</script>

<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
      tex2jax: {
        skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
      }
    });
</script>

<script type="text/x-mathjax-config">
    MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax(), i;
        for(i=0; i < all.length; i += 1) {
            all[i].SourceElement().parentNode.className += ' has-jax';
        }
    });
</script>

<script type="text/javascript"
   src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>

  
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-4132881-1']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>


</head>

<body    class="collapse-sidebar sidebar-footer" >
  <header role="banner"><hgroup>
  <h1><a href="/">Software, Physics, Data, Mountains</a></h1>
  
    <h2>...and other random associations</h2>
  
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
<form action="http://google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="q" value="site:markmims.com" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
  <li><a href="/">Blog</a></li>
  <li><a href="/blog/archives">Archives</a></li>
  <li><a href="/about.html">About</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div>
<article class="hentry" role="article">
  
  <header>
    
      <h1 class="entry-title">Monitoring Hadoop Benchmarks TeraGen/TeraSort With Ganglia</h1>
    
    
      <p class="meta">
        








  


<time datetime="2011-09-03T00:00:00-06:00" pubdate data-updated="true">Sep 3<span>rd</span>, 2011</time>
        
      </p>
    
  </header>


<div class="entry-content"><p>Here I’m using new features of
<a href="http://www.ubuntu.com/business/server/overview">Ubuntu Server</a> 
(namely <a href="http://juju.ubuntu.com">juju</a>)
to easily deploy
<a href="http://ganglia.sourceforge.net">Ganglia</a>
alongside
a small <a href="http://hadoop.apache.org">Hadoop</a> cluster
to play around with monitoring some
<a href="http://sortbenchmark.org/">benchmarks</a>
like
<a href="http://www.michael-noll.com/blog/2011/04/09/benchmarking-and-stress-testing-an-hadoop-cluster-with-terasort-testdfsio-nnbench-mrbench/">Terasort</a>.</p>

<!--more-->

<hr />

<p><em>Updated on 2011-11-08:</em>
The ubuntu project “ensemble” is now known as “juju”.
This post has been updated to reflect the new names and updates to the api.</p>

<hr />

<h2 id="short-story">Short Story</h2>

<p>Deploy hadoop and ganglia using juju:</p>

<pre><code>$ juju bootstrap
$ juju deploy --repository "~/charms"  local:hadoop-master namenode
$ juju deploy --repository "~/charms"  local:ganglia jobmonitor
$ juju deploy --repository "~/charms"  local:hadoop-slave datacluster
$ juju add-relation namenode datacluster
$ juju add-relation jobmonitor datacluster
$ for i in {1..6}; do
$   juju add-unit datacluster
$ done
$ juju expose jobmonitor
</code></pre>

<p>When all is said and done (and EC2 has caught up),
run the jobs</p>

<pre><code>$ juju ssh namenode/0
ubuntu$ sudo -su hdfs
hdfs$ hadoop jar hadoop-*-examples.jar teragen -Dmapred.map.tasks=100 -Dmapred.reduce.tasks=100 100000000 in_dir
hdfs$ hadoop jar hadoop-*-examples.jar terasort -Dmapred.map.tasks=100 -Dmapred.reduce.tasks=100 in_dir out_dir
</code></pre>

<p>While these are running, we can run</p>

<pre><code>$ juju status
</code></pre>

<p>to get the URL for the jobmonitor ganglia web frontend</p>

<pre><code>http://&lt;jobmonitor-instance-ec2-url&gt;/ganglia/
</code></pre>

<p>and see…</p>

<p><a href="/images/terasort-ganglia-1.png">
<img src="/images/terasort-ganglia-1.png" width="720px" />
</a></p>

<p>and a little later as the jobs run…</p>

<p><a href="/images/terasort-ganglia-2.png">
<img src="/images/terasort-ganglia-2.png" width="720px" />
</a></p>

<p>Of course, I’m just playing around with ganglia at the moment…
For real performance, I’d change my juju config file
to choose larger (and ephemeral) EC2 instances instead of
the defaults.</p>

<h2 id="a-few-details">A Few Details…</h2>

<p>Let’s grab the charms necessary to reproduce this.</p>

<p>First, let’s install juju and set up a our charms.</p>

<pre><code>$ sudo apt-get install juju charm-tools
</code></pre>

<p>Note that I’m describing all this using an Ubuntu laptop to run
the juju cli because that’s how I roll, but you can certainly
use a Mac to drive your Ubuntu services in the cloud.
The juju CLI is already available in ports, but I’m not sure
the version.  Homebrew packages are in the works.
Windows should work too, but I don’t have a clue.</p>

<pre><code>$ mkdir -p ~/charms/oneiric
$ cd ~/charms/oneiric
$ charm get hadoop-master
$ charm get hadoop-slave
$ charm get ganglia
</code></pre>

<p>That’s about all that’s really necessary to get you up and
benchmarking/monitoring.</p>

<p>I’ll do another post on how to adapt your own charms to use monitoring
and the <code>monitor</code> juju interface as part of the “Core Infrastructure”
series I’m writing for charm developers.  I’ll go over the process of
what I had to do to get the <code>hadoop-slave</code> service talking to monitoring
services like <code>ganglia</code>.</p>

<p>Until then, clone/test/enjoy… or better yet, fork/adapt/use!</p>

</div>


  <footer>
    <p class="meta">
      
  

<span class="byline author vcard">Posted by <span class="fn">Mark M Mims, Ph.D.</span></span>

      








  


<time datetime="2011-09-03T00:00:00-06:00" pubdate data-updated="true">Sep 3<span>rd</span>, 2011</time>
      

<span class="categories">
  
    <a class='category' href='/blog/categories/cloud/'>cloud</a>
  
</span>


    </p>
    
      <div class="sharing">
  
  <a href="http://twitter.com/share" class="twitter-share-button" data-url="http://markmims.com/cloud/2011/09/03/terasort-ganglia.html" data-via="m_3" data-counturl="http://markmims.com/cloud/2011/09/03/terasort-ganglia.html" >Tweet</a>
  
  
  <div class="g-plusone" data-size="medium"></div>
  
  
</div>

    
    <p class="meta">
      
        <a class="basic-alignment left" href="/cloud/2011/08/25/juju-nfs.html" title="Previous Post: Core Infrastructure Part 1 - Adding NFS to juju charms">&laquo; Core Infrastructure Part 1 - Adding NFS to juju charms</a>
      
      
        <a class="basic-alignment right" href="/cloud/2011/09/07/node-mongo-ubuntu.html" title="Next Post: Node.js and MongoDB on Ubuntu">Node.js and MongoDB on Ubuntu &raquo;</a>
      
    </p>
  </footer>
</article>

  <section>
    <h1>Comments</h1>
    <div id="disqus_thread" aria-live="polite"><noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</div>
  </section>

</div>

<aside class="sidebar">
  
    <!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
  <section>
    <div id='container'>
      <div id='about-sidebar'>
      </div>
      <br/>
    </div>
    <script type='text/javascript'>
      var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
      document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
    </script>
    <script type='text/javascript'>
      var pageTracker = _gat._getTracker("UA-4132881-1");
      pageTracker._initData();
      pageTracker._trackPageview();
    </script>
  </section>
<section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/data-engineering/spark/hadoop/devops/2016/03/17/hwtb-sessions.html">Identifying User Activity from Streams of Raw Events</a>
      </li>
    
      <li class="post">
        <a href="/datascience/2015/10/16/educational-components.html">Educational Components</a>
      </li>
    
      <li class="post">
        <a href="/docker/data-engineering/spark/devops/2015/10/13/docker-cdh.html">Develop Spark Apps on Yarn using Docker</a>
      </li>
    
      <li class="post">
        <a href="/2015/06/01/ssh-tips.html">SSH Tips and Tricks</a>
      </li>
    
      <li class="post">
        <a href="/cloud/2013/08/23/charmschool-local-provider.html">CharmSchool Hangout - Juju Local Provider</a>
      </li>
    
  </ul>
</section>

  
</aside>


    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2018 - Mark M Mims, Ph.D. -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>

</footer>
  

<script type="text/javascript">
      var disqus_shortname = 'markmims';
      
        
        // var disqus_developer = 1;
        var disqus_identifier = 'http://markmims.com/cloud/2011/09/03/terasort-ganglia.html';
        var disqus_url = 'http://markmims.com/cloud/2011/09/03/terasort-ganglia.html';
        var disqus_script = 'embed.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = 'http://' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>





  <script type="text/javascript">
    (function() {
      var script = document.createElement('script'); script.type = 'text/javascript'; script.async = true;
      script.src = 'https://apis.google.com/js/plusone.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(script, s);
    })();
  </script>



  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = 'http://platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>





</body>
</html>
